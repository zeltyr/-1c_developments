# Заметки по ERP

## Общие модули

* Модуль "ПартнерыИКонтрагенты"
  * Содержит функции для работы и синхронизации справочников, иной раз удобно использовать функции оттуда, н-р:
  
  ```1с
  КонтрагентСсылка = ПартнерыИКонтрагенты.ПолучитьКонтрагентаПартнераПоУмолчанию(ПартнерСсылка);
  ```

* Если стоит функциональная опция "ИспользоватьПартнеровКакКонтрагентов" создавать надо и партнёров и контрагентов
  * при этом часть информации для отображения в форме контрагента тянется из партнёра (н-р: дата рождения)

* Модуль "ОбменССайтом...." - содержит алгоритмы по загрузке данных из сторонних программ, чтоб не выдумывать свой велосипед

```1с
ОбменССайтомПереопределяемый.ЗаполнитьЗаказ(ДокументОбъект, РеквизитыЗаказа, СвойстваЗаказа, ПрикладныеПараметры, ОписаниеОшибки, Успешно);

СамообслуживаниеСервер.ОформитьЗаказ();
```

## Работа с контактной информацией

```1с
// ПАРАМЕТРЫ:
//    ОбъектДляЗаполнения - СправочникОбъект.Контрагенты, СправочникОбъект.Партнеры 
//    ДанныеДляЗагрузки - Структура
//    ДатаЗагрузки - Дата
//
Процедура ЗаполнитьКонтактнуюИнформацию(ОбъектДляЗаполнения, ДанныеДляЗагрузки, ДатаЗагрузки)

    ДатаЗагрузки = ТекущаяДатаСеанса();

    Если ТипЗнч(ОбъектДляЗаполнения) = Тип("СправочникОбъект.Партнеры") Тогда

        ВидАдрес = УправлениеКонтактнойИнформацией.ВидКонтактнойИнформацииПоИмени("АдресПартнера");
        ВидТелефон = УправлениеКонтактнойИнформацией.ВидКонтактнойИнформацииПоИмени("ТелефонПартнера");
        ВидЭлектронныйАдрес = УправлениеКонтактнойИнформацией.ВидКонтактнойИнформацииПоИмени("EmailПартнера");

    Иначе

        ВидАдрес = УправлениеКонтактнойИнформацией.ВидКонтактнойИнформацииПоИмени("ЮрАдресКонтрагента");
        ВидТелефон = УправлениеКонтактнойИнформацией.ВидКонтактнойИнформацииПоИмени("ТелефонКонтрагента");
        ВидЭлектронныйАдрес = УправлениеКонтактнойИнформацией.ВидКонтактнойИнформацииПоИмени("EmailКонтрагента");

    КонецЕсли;
    
    // адрес
    ДанныеАдреса = СтрШаблон("%1, %2 г", ДанныеДляЗагрузки.Страна, ДанныеДляЗагрузки.Город);
    УправлениеКонтактнойИнформацией.ДобавитьКонтактнуюИнформацию(
        ОбъектДляЗаполнения, 
        ДанныеАдреса, 
        ВидАдрес, 
        ДатаЗагрузки);

    // телефон
    ДанныеТелефона = ДанныеДляЗагрузки.Телефон;
    УправлениеКонтактнойИнформацией.ДобавитьКонтактнуюИнформацию(
        ОбъектДляЗаполнения, 
        ДанныеТелефона, 
        ДанныеДляЗагрузки.Телефон, 
        ДатаЗагрузки);

    // e-mail
    УправлениеКонтактнойИнформацией.ДобавитьКонтактнуюИнформацию(
        ОбъектДляЗаполнения, 
        ДанныеДляЗагрузки.ЭлектронныйАдрес, 
        ВидЭлектронныйАдрес, 
        ДатаЗагрузки);

КонецПроцедуры
```
